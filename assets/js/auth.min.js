import app from"/js/site.min.js";const d=app.d,df=d.domfn,authLauncher=d.query(".auth-launcher"),{authView:authView,usernameInput:usernameInput,passwordInput:passwordInput,authBtn:authBtn}=d.h`
<section class="auth-view" ref="authView">
  <div>
    <div class="auth-form-field">
      <label for="auth-username">Username</label>
      <input type="text" name="username" id="auth-username" ref="usernameInput">
      <label for="auth-pwd">Password</label>
      <input type="password" name="password" id="auth-pwd" ref="passwordInput">
    </div>
    <button class="submit" ref="authBtn">authenticate</button>
  </div>
</section>`.collect();app.authView=authView,app.authViewToggle=(a=!df.hasClass(authView,"open"))=>{df.class(authView,"open",a),df.class(authLauncher,"active",a),a?(d.render(authView),clickOutHandler.on()):df.remove(authView)};const clickOutHandler=d.on.pointerdown(document.body,a=>{a.target!=authView&&!authView.contains(a.target)&&df.hasClass(authView,"open")&&a.target!=authLauncher&&(a.preventDefault(),app.authViewToggle(!1),clickOutHandler.off())}).off();d.on.pointerdown(authLauncher,app.clickAuthLauncher=a=>{a.preventDefault(),app.authViewToggle()}),app.authenticate=async(a=usernameInput.value.trim(),t=passwordInput.value.trim())=>{if(""==a)throw new Error("username is invalid");if(""==t)throw new Error("password is invalid");console.log("attempting authentication");const e=await app.jsonPost("/auth",{username:a,password:t}),n=await e.json();console.log(n),n.ok&&location.reload()};const authClickHandle=d.once.click(authBtn,async a=>{try{await app.authenticate()}catch(a){console.error(a),authClickHandle.on()}});app.authViewToggle();