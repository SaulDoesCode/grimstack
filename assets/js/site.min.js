import domlib from"/js/domlib.min.js";const app=domlib.emitter(),d=app.d=domlib,df=domlib.domfn,reqWithBody=(t="application/json",e=JSON.stringify)=>o=>(a,n,i={})=>fetch(a,{method:o,headers:{"Content-Type":t},body:e(n),...i}),jsonHTTPMethod=reqWithBody(),textHTTPMethod=reqWithBody("text/plain",t=>t);app.jsonPost=jsonHTTPMethod("POST"),app.jsonPut=jsonHTTPMethod("PUT"),app.jsonDelete=jsonHTTPMethod("DELETE"),app.txtPost=textHTTPMethod("POST"),app.txtPut=textHTTPMethod("PUT"),app.txtDelete=textHTTPMethod("DELETE");const wq=t=>async(e={})=>{isNaN(e.page)&&(e.page=0),e.kind||(e.kind="post");const o=await app.jsonPost(t,e);return await o.json()};app.writQuery=wq("/writs"),app.editableWritQuery=wq("/editable-writs"),app.toggleSituations={list:[],active:null},app.setupToggleSituation=(t,e,o="body",{viewOutAnimation:a,delayRemoveMS:n,background:i}={})=>{const p={};return p.clickOutHandler=d.on.pointerdown(document.body,o=>{o.target!=e&&!e.contains(o.target)&&df.hasClass(e,"open")&&o.target!=t&&(o.preventDefault(),p.toggleView(!1),p.clickOutHandler.off())}).off(),p.launchEventHandler=d.on.pointerdown(t,t=>{t.preventDefault(),p.toggleView()}),!0===i&&(i=df.div({class:"background-cover"})),p.toggleView=(s=!df.hasClass(e,"open"))=>{df.class(e,"open",s),df.class(t,"active",s),s?(i&&d.render(i),d.render(e,o),p.clickOutHandler.on(),app.toggleSituations.active&&app.toggleSituations.active.toggleView(!1),app.toggleSituations.active=p):(app.toggleSituations.active==p&&(app.toggleSituations.active=null),null!=n?(e.style.animation=a,p.launchEventHandler.off(),df.remove(e,n).then(()=>{i&&df.remove(i),e.style.animation="",p.launchEventHandler.on()})):(i&&df.remove(i),df.remove(e)))},app.toggleSituations.list.push(p),p},app.loadScriptsThenRunSequentially=(t,...e)=>new Promise(async(o,a)=>{const n=setTimeout(a,3e3*e.length),i=e[e.length-1];let p="";if(t&&i in localStorage)p=localStorage.getItem(i);else{const o={},a=[];for(const t of e)a.push(fetch(t).then(t=>t.text()).then(e=>{o[t]=e}));await Promise.all(a);for(const t in o)p+="\n;"+o[t];p+=`\n; app.emit("doneLoading:${i}");`,t&&localStorage.setItem(i,p)}app.once["doneLoading:"+i](o),df.script({$:document.head},p),clearTimeout(n)}),app.loadStyle=async(t,e)=>{let o;e&&t in localStorage?o=localStorage.getItem(t):(o=await(await fetch(t)).text(),e&&localStorage.setItem(t,o)),df.style({$:document.head},o)};const abreviateNum_units=["k","M","G","T","P","E","Z","Y"];app.abreviateNum=(t,e)=>{for(let o,a=abreviateNum_units.length-1;a>=0;a--)if(o=Math.pow(1e3,a+1),t<=-o||t>=o)return+(t/o).toFixed(e)+abreviateNum_units[a];return t},app.components={},app.components.toggleBox=(t,{id:e,checked:o,...a}={})=>df.div({class:"togglebox"},n=>n.input=df.input(d.merge({attr:{name:t,id:e,checked:o,type:"checkbox"}},a)),df.span()),domlib.createElementPlugins.contingentVisibility=(t,e)=>{if(domlib.isArr(t))var[t,o]=t;domlib.isStr(t)&&app.on["cv:"+t](t=>{t?e.removeAttribute("hidden"):e.setAttribute("hidden",!0),domlib.isFunc(o)&&o(t)})},app.dismissIcon=()=>domlib.html('<svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" style="width: 16px; height: 22px;">\n<polygon fill="rgb(255, 66, 66)" points="11.649 9.882 18.262 3.267 16.495 1.5 9.881 8.114 3.267 1.5 1.5 3.267 8.114 9.883 1.5 16.497 3.267 18.264 9.881 11.65 16.495 18.264 18.262 16.497">\n</polygon>\n</svg>'),app.cv=(t,e)=>{if(app.cv.map[t]==e)return!1;void 0===e&&(e=!app.cv.map[t]),app.emit["cv:"+t](app.cv.map[t]=!!e)},app.cv.check=t=>!!app.cv.map[t],app.cv.map=Object.create(null),app.toastContainer=df.section({$:"body",class:"toast-container",contingentVisibility:"gotToast"}),app.cv("gotToast",!1),app.toastList=new Set,app.toast=new Proxy((t,e,o=15e3)=>{app.cv("gotToast",!0);const a=()=>{df.remove(n),app.toastList.delete(n),0==app.toastList.size&&app.cv("gotToast",!1)},n=df.div({$:app.toastContainer,class:"toast "+t},df.span(e),df.span({class:"dismiss-btn",onceclick(){a()}},app.dismissIcon()));return app.toastList.add(n),df.remove(n,o).then(a),n},{get:(t,e)=>t.bind(null,e)}),window.app=app;export default app;
//# sourceMappingURL=site.min.js.map