import domlib from"/js/domlib.min.js";const app=domlib.emitter(),d=app.d=domlib,df=domlib.domfn,reqWithBody=(t="application/json",e=JSON.stringify)=>o=>(n,a,i={})=>fetch(n,{method:o,headers:{"Content-Type":t},body:e(a),...i}),jsonHTTPMethod=reqWithBody(),textHTTPMethod=reqWithBody("text/plain",t=>t);app.jsonPost=jsonHTTPMethod("POST"),app.jsonPut=jsonHTTPMethod("PUT"),app.jsonDelete=jsonHTTPMethod("DELETE"),app.txtPost=textHTTPMethod("POST"),app.txtPut=textHTTPMethod("PUT"),app.txtDelete=textHTTPMethod("DELETE");const wq=t=>async(e={})=>{isNaN(e.page)&&(e.page=1),e.kind||(e.kind="post");const o=await app.jsonPost(t,e);return await o.json()};app.writQuery=wq("/writs"),app.editableWritQuery=wq("/editable-writs"),app.toggleSituations={list:[],active:null},app.setupToggleSituation=(t,e,o="body",{viewOutAnimation:n,delayRemoveMS:a}={})=>{const i={};return i.clickOutHandler=d.on.pointerdown(document.body,o=>{o.target!=e&&!e.contains(o.target)&&df.hasClass(e,"open")&&o.target!=t&&(o.preventDefault(),i.toggleView(!1),i.clickOutHandler.off())}).off(),i.launchEventHandler=d.on.pointerdown(t,t=>{t.preventDefault(),i.toggleView()}),i.toggleView=(p=!df.hasClass(e,"open"))=>{df.class(e,"open",p),df.class(t,"active",p),p?(d.render(e,o),i.clickOutHandler.on(),app.toggleSituations.active&&app.toggleSituations.active.toggleView(!1),app.toggleSituations.active=i):(app.toggleSituations.active==i&&(app.toggleSituations.active=null),null!=a?(e.style.animation=n,i.launchEventHandler.off(),df.remove(e,a).then(()=>{e.style.animation="",i.launchEventHandler.on()})):df.remove(e))},app.toggleSituations.list.push(i),i},app.loadScriptsThenRunSequentially=(...t)=>new Promise(async(e,o)=>{const n=setTimeout(o,3e3*t.length),a={},i=[];for(const e of t)i.push(fetch(e).then(t=>t.text()).then(t=>{a[e]=t}));await Promise.all(i);let p="";for(const t in a)p+="\n\n; "+a[t];const l=t[t.length-1];p+=`; app.emit("doneLoading:${l}");`,app.once["doneLoading:"+l](e),df.script({$:document.head},p),clearTimeout(n)}),window.app=app;export default app;
//# sourceMappingURL=site.min.js.map