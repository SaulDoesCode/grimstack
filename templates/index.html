<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Grimstack</title>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="modulepreload" href="/js/domlib.min.js">
    <link rel="modulepreload" href="/js/router.min.js">
    {% if not dev_mode or dev_mode is undefined  %}
    <link href="https://fonts.googleapis.com/css2?family=Cantarell:wght@400;700&display=swap" rel="stylesheet">
    {% endif %}
    <link rel="stylesheet" href="/css/marx.min.css">
    <link rel="stylesheet" href="/css/site.min.css">
    {% if username is undefined %}
    <link rel="stylesheet" href="/css/auth.min.css">
    {% else %}
    <link rel="stylesheet" href="/css/postauth.min.css">
    {% endif %}
    <script src="/js/site.min.js" type="module"></script>
    <script src="/js/view.min.js" type="module"></script>
</head>
<body>
    <nav class="hero">
        <header>Grimstack</header>
        <section class="launchers">
        {% if username is defined %}
            {% if is_writer %}
            <button class="ww-launcher" title="open up the writ writer and post something">
                WritWriter
            </button>
            {% endif %}

            <button class="profile-launcher" title="click to see or build your profile">{{ username }}</button>
            <script type="module" defer>
                import app from '/js/site.min.js'
                app.user = { username: "{{ username }}".trim() }
                import('/js/profile.min.js')
                // d.once.click('.profile-launcher', () => {})
                {% if is_writer %}
                app.d.once.click('.ww-launcher', () => import('/js/writ-writer.min.js'))
                {% endif %}
            </script>
        {% else %}
            <button class="auth-launcher" title="click for a login or signup modal">Auth</button>
            <script type="module" defer>
                import d from '/js/domlib.min.js'
                d.once.click('.auth-launcher', async e => {
                    e.preventDefault()
                    import('/js/auth.min.js')
                })
            </script>
        {% endif %}
        </section>
    </nav>

    <main class="content-display" route-active></main>
</body>
</html>